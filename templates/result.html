<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cosmic Blueprint Results</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header class="text-center my-4">
            <h1><i class="fas fa-moon me-2"></i> Your Spiritual Blueprint</h1>
            <p class="lead">Map of Your Energetic System</p>
        </header>
        
        <!-- Birth Information -->
        <div class="birth-info mb-4">
            <div class="row">
                <div class="col-md-6">
                    <h5>
                        {% if birth_details.name %}
                            {{ birth_details.name }}'s Birth Chart
                        {% else %}
                            Birth Chart
                        {% endif %}
                    </h5>
                    <p><strong>Date:</strong> {{ birth_details.date }}</p>
                    <p><strong>Time:</strong> {{ birth_details.time }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Location:</strong> {{ birth_details.location }}</p>
                    <p><strong>Coordinates:</strong> {{ birth_details.coordinates[1] }}° N, {{ birth_details.coordinates[0] }}° E</p>
                    <p><strong>System:</strong> Vedic Sidereal Zodiac (Lahiri Ayanamsa)</p>

                </div>
            </div>
        </div>
        
        <!-- Ascendant Section -->
        {% if ascendant %}
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0">Ascendant (Lagna)</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-12">
                        <p class="lead">
                            Your ascendant is <strong class="sign-{{ ascendant.sign.lower() }}">{{ ascendant.formatted }}</strong>
                        </p>
                        <p>
                            The ascendant, also known as the "lagna" in Vedic astrology, is perhaps the most important point in your birth chart. 
                            It represents your physical appearance, personality, approach to life, and how others perceive you. The ascendant 
                            changes signs approximately every two hours, making it one of the most personalized aspects of your birth chart.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Planets Section -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0">Planetary Positions</h3>
            </div>
            <div class="card-body">
                <table class="table table-striped planet-table">
                    <thead>
                        <tr>
                            <th>Planet</th>
                            <th>Position</th>
                            <th>Nakshatra</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for planet in planets %}
                        <tr>
                            <td>
                                <strong class="{% if planet.retrograde %}retrograde{% endif %}">
                                    {{ planet.name }}
                                </strong>
                            </td>
                            <td>
                                <span class="sign-{{ planet.sign.lower() }}">
                                    {{ planet.formatted_position }}
                                </span>
                            </td>
                            <td>
                                {{ planet.nakshatra.name }}
                                <div class="nakshatra-info">
                                    {{ planet.nakshatra.position }} - {{ planet.nakshatra.ruling_planet }}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Planet Descriptions Section -->
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h3 class="mb-0">Planet Descriptions</h3>
            </div>
            <div class="card-body">
                <p class="mb-4">
                    Below are descriptions of each planet's astrological significance. Each celestial body has its own unique influence and meaning in Vedic astrology.
                </p>
                
                <div class="row row-cols-1 row-cols-md-2 g-4">
                    {% for planet in planets %}
                    <div class="col">
                        <div class="card planet-card h-100">
                            <div class="card-header bg-dark">
                                <span class="{% if planet.retrograde %}retrograde{% endif %}">{{ planet.name }}</span> in 
                                <span class="sign-{{ planet.sign.lower() }}">{{ planet.sign }}</span>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <strong>Position:</strong> {{ planet.formatted_position }}
                                    {% if planet.retrograde %}
                                        <span class="badge bg-warning text-dark ms-2">Retrograde</span>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <strong>Nakshatra:</strong> {{ planet.nakshatra.name }} ({{ planet.nakshatra.position }})
                                    <div><small>Ruling planet: {{ planet.nakshatra.ruling_planet }}</small></div>
                                </div>
                                
                                <p class="card-text">
                                    {{ planet.description }}
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- Planet data for database storage -->
        <div id="planets-data" style="display:none;"></div>
        
        <!-- Save Chart Form -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0">Save This Chart</h3>
            </div>
            <div class="card-body">
                <form action="{{ url_for('save_chart') }}" method="post">
                    <!-- Hidden fields to store all the chart data -->
                    <input type="hidden" name="name" value="{{ birth_details.name }}">
                    <input type="hidden" name="birth_date" value="{{ birth_details.date }}">
                    <input type="hidden" name="birth_time" value="{{ birth_details.time }}">
                    <input type="hidden" name="city" value="{{ birth_details.location.split(',')[0] | trim }}">
                    <input type="hidden" name="country" value="{{ birth_details.location.split(',')[1] | trim }}">
                    <input type="hidden" name="latitude" value="{{ birth_details.coordinates[1] }}">
                    <input type="hidden" name="longitude" value="{{ birth_details.coordinates[0] }}">
                    <input type="hidden" name="planets_json" value="{{ planets|tojson|safe }}">
                    
                    <div class="mb-3">
                        <label for="notes" class="form-label">Notes (optional)</label>
                        <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="Add any notes about this chart...">{{ notes|default('') }}</textarea>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save me-2"></i> Save Chart
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="text-center mt-4 mb-4">
            <a href="{{ url_for('index') }}" class="btn btn-outline-primary me-2">
                <i class="fas fa-arrow-left me-2"></i> Calculate Another Chart
            </a>
            <a href="{{ url_for('list_charts') }}" class="btn btn-outline-info me-2">
                <i class="fas fa-list me-2"></i> View Saved Charts
            </a>
            

        </div>
        
        <footer class="text-center my-4">
            <p class="text-muted">
                <small>
                    Your Cosmic Blueprint Calculator &copy; 2025 | 
                    Using Lahiri ayanamsa and authentic sidereal calculations
                </small>
            </p>
        </footer>
    </div>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
